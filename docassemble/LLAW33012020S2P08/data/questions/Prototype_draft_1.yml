---
#Code to enable endpoint event
objects:
  - endpoint: DADict
---
#Code to include seperately maintained threshold table
include: 
  - Threshold_Tables_2.yml  
  - Question_folder_draft_1.yml
---
# This is the ineligible endpoint
event: endpoint['ineligible']
question: Eligibility requirements not met
subquestion:
  You are not eligible to use this application as you have indicated that you work more than 30 hours a week.

  Your DSP will be cut off if you work for 30 hours or more a week.
  
  Please visit the centerlink website for more information.
  
buttons:
  - Exit: exit
  - Learn More: logout
    url: https://www.servicesaustralia.gov.au/individuals/services/centrelink/disability-support-pension/how-manage-your-payment/hours-you-can-work#:~:text=You%20may%20be%20able%20to,than%2030%20hours%20a%20week.
  - Restart: restart
---
# This is the ELIGIBLE endpoint
event: endpoint['eligible']
question: A screen
subquestion: | 
  Question|Answer
  ---|---
  **Hours you work per week**| ${ user_hours } hours
  **Your age**| ${ P08age }
  ** Do you have any dependent children? ** | ${ P08has_chn }
  **Your maritial status**| ${ P08is_married }
  % if P08is_married != 'Single':
  ** Are you living apat or together?**| ${ P08_married_apart }
  % endif
  % if P08is_married != 'over_21' and P08chn_cat != 'has_chn':
  ** Are you living at home or independently?**| ${ P08_Dependence }
  % endif
  **Your income per fortnight**| ${ currency(P08income) }
  **Your current DSP is** | ${ currency(P08dspincome) }
  **How much DSP is deducted**| ${ currency(amount_deducted) }
---
#Code to run threshold - eligible OR ineligible 
mandatory: True
code: |
  if user_hours >= 30:
    endpoint['ineligible']
  else:
    endpoint['eligible']
---
code: |
   if P08age_category == 'over_21' and P08chn_cat == 'has_chn' and P08is_married == 'Single':
      P08fourth_subcat = 'NA'
      
   if P08age_category == 'over_21' and P08chn_cat == 'no_chn' and P08is_married == 'Single':
      P08fourth_subcat = 'NA'
      
   elif P08age_category == 'over_21' and P08chn_cat == 'has_chn' and P08is_married == 'Couple'and P08_married_apart == 'Living togather' :
      P08fourth_subcat = 'Living togather'
      
   elif P08age_category == 'over_21' and P08chn_cat == 'has_chn' and P08is_married == 'Couple'and P08_married_apart == 'Living apart due to illness' :
      P08fourth_subcat = 'Living apart due to illness'

   elif P08age_category == '18to20' and P08chn_cat == 'no_chn' and P08is_married == 'Single' and P08_Dependence == 'At Home':
      P08fourth_subcat = 'At Home' 

   elif P08age_category == '18to20' and P08chn_cat == 'no_chn' and P08is_married == 'Single' and P08_Dependence == 'Independent':
      P08fourth_subcat = 'Independent'

   elif P08age_category == '18to20' and P08chn_cat == 'no_chn' and P08is_married == 'Couple':
      P08fourth_subcat = 'NA'
      
   elif P08age_category == 'below_18' and P08chn_cat == 'no_chn' and P08is_married == 'Couple':
      P08fourth_subcat = 'NA' 
      
   elif P08age_category == 'below_18' and P08chn_cat == 'has_chn' and P08is_married == 'Couple':
      P08fourth_subcat = 'At Home' 
      
   elif P08age_category != 'over_21' and P08chn_cat == 'has_chn' and P08is_married == 'Single':
      P08fourth_subcat = 'NA'
      
   elif P08age_category != 'over_21' and P08chn_cat == 'has_chn' and P08is_married == 'Couple'and P08_married_apart == 'Living togather' :
      P08fourth_subcat = 'Living togather'
      
   elif P08age_category != 'over_21' and P08chn_cat == 'has_chn' and P08is_married == 'Couple'and P08_married_apart == 'Living apart due to illness' :
      P08fourth_subcat = 'Living apart due to illness'      
---
code: |
  temp_income = P08income - my_no_pen
  amount_deducted = temp_income / my_ded_incr * my_ded_amt
---
code: |
  my_thresholds = threshold_table[P08age_category][P08chn_cat][P08is_married][P08fourth_subcat]
  my_DSP_cutoff = my_thresholds['DSP_cutoff']
  my_no_pen = my_thresholds['no_pen_thr']
  my_ded_amt = my_thresholds['ded_amt']
  my_ded_incr = my_thresholds['ded_inc']
---