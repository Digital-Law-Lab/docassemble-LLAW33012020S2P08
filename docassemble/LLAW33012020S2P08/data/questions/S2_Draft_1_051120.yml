---
#Code to enable endpoint event
objects:
  - endpoint: DADict
---
#Code to include seperately maintained threshold table
include: 
  - S2_Draft_1_051120_Threshold_Table.yml  
  - S2_Draft_1_051120_Question_Folder.yml
  - S2_Draft_1_051120_Modified_if_code_block.yml

---
# Features: refers to the .css file for bootstrap settings
features:
  css: C4_01_lnf_with_comments.css
  debug: True
  hide standard menu: False
---
# Logo: the CBS logo in the navbar
objects:
  - P08logo: DAStaticFile.using(filename='CBSInc-logo.png')
---
# Logo: the CBS logo in the navbar
mandatory: True
code: |
  set_parts(logo='<img src="' + P08logo.url_for() + '" style="height: 50px;">')
---
# Welcome Page
mandatory: True
question: |
  Community Bridging Services (CBS) Inc.
subquestion: |
  Welcome to the CBS Inc. Disability Support Pension (DSP) application. This application is designed to inform you about any effect that your income may have on your DSP payments.
  
  ---
  
  **Disclaimer:**

  **This application does not provide legal advice** and should not be considered as a substitute for legal advice. 
  
  This application will ask for your personal information. Please note, the information you provide will not be saved or stored. The information you provide is confidential and anonymous. 
  
  Please see the CBS Inc. [privacy policy](https://communitybridgingservices.org.au/wp-content/uploads/2018/05/Privacy-Policy.pdf) for more information.
  
  If you have any questions, please contact us by using [this link](https://communitybridgingservices.org.au/contact-us/) or by calling 8224 2900.
  
  **By continuing, you accept these terms.**
buttons:
  - I accept and wish to continue: continue
  - I do not accept and wish to exit: exit
    url: https://communitybridgingservices.org.au/
---
# This is the 1ST ineligible endpoint
event: endpoint['ineligible_1']
question: Eligibility requirements not met
subquestion:
  You are not eligible to use this application as you have indicated that you are **not** a recipient of the DSP.

buttons:
  - Exit: exit
    url: https://communitybridgingservices.org.au/
  - Learn More: logout
    url: https://www.servicesaustralia.gov.au/individuals/services/centrelink/disability-support-pension
  - Restart: restart
---  
# This is the 2ND ineligible endpoint
event: endpoint['ineligible_2']
question: Eligibility requirements not met
subquestion: |

  * You are not eligible to use this application as you have indicated that you work for **30 or more hours a week.**

  * Your DSP may be stopped if you work for **30 or more hours a week.**
  
  * Please [contact Centrelink](https://www.servicesaustralia.gov.au/individuals/contact-us) for more information.

  * You may choose to continue without your DSP for a time. You may resume your DSP anytime **within 2 years** of it being stopped, as long as you meet the eligibility requirements again.
  
buttons:
  - Exit: exit
  - Learn More: logout
    url: https://www.servicesaustralia.gov.au/individuals/services/centrelink/disability-support-pension/how-manage-your-payment/hours-you-can-work
  - Restart: restart
---
# This is the ELIGIBLE endpoint
event: endpoint['eligible']
question: You have reached the end of the survey
subquestion: | 

 Your DSP **may** be reduced due to an increase in working hours/earnings. This amount is stated at the bottom of the table.

 You have provided us with the following information:
 

  Question|Answer
  ---|---
  **Hours you work per week**| ${ user_hours } hours
  **Your age**| ${ P08age }
  ** Do you have any dependent children? ** | ${ P08has_chn }
  **Your relationship status**| ${ P08is_married }
  % if P08is_married != 'Single' and P08age_category == 'over_21':
  ** Are you living apart or together?**| ${ P08_married_apart }
  % endif
  % if P08age_category != 'over_21' and P08chn_cat == 'no_chn' and P08is_married == 'Single':
  ** Are you living at home or independently?**| ${ P08_Dependence }
  % endif
  **Your income per fortnight before tax**| ${ currency(P08income) }
  **Your current DSP is** | ${ currency(P08dspincome) }
  **How much DSP is deducted**| ${ currency(amount_deducted) } 
  **Extra hours you intend to work per week**| ${ user_additional_hours } hours per week
  **How much more will you earn**| ${ currency(P08_additional_income) } per fortnight
  
  You will be earning ${ currency(P08_new_income) } per fortnight including your DSP.
  % if P08_new_income > my_thresholds['DSP_cutoff']:
      You will be earning more than the DSP threshhold income and may **no longer** be eligible for the DSP.
  % endif

 You will be working ${ P08_new_hours } hours a fortnight.   
  % if P08_new_hours > 30:
      You will be working more than the DSP 30 hours limit and may **no longer** be  eligible for the DSP.
  % endif

 This application merely intends to **estimate** how your DSP **may** be affected. Please [contact Centrelink](https://www.servicesaustralia.gov.au/individuals/contact-us) to confirm the status of your DSP.

 Thank you for completing this application.

buttons:  
 - Exit: exit
   url: https://communitybridgingservices.org.au/
 - Try Again: restart
---
#Code to run threshold - eligible OR ineligible 
#REMOVED and ADDED new component in table above
  # elif P08income > my_thresholds['DSP_cutoff']:
  # endpoint['ineligible_3']
mandatory: True
code: |
  if user_DSP == 'No':
    endpoint['ineligible_1']
  elif user_hours >= 30:
    endpoint['ineligible_2']
  else:
    endpoint['eligible']
  
---
code: |
  temp_income = P08income - my_no_pen
  amount_deducted = temp_income / my_ded_incr * my_ded_amt
---
code: |
  my_thresholds = threshold_table[P08age_category][P08chn_cat][P08is_married][P08fourth_subcat]
  my_DSP_cutoff = my_thresholds['DSP_cutoff']
  my_no_pen = my_thresholds['no_pen_thr']
  my_ded_amt = my_thresholds['ded_amt']
  my_ded_incr = my_thresholds['ded_inc']
---
#Code for new total income
code: |
  a = P08_additional_income
  b = P08income
  c = amount_deducted
  P08_new_income = a + b - c
---  
code: |
  P08_new_hours = user_hours + user_additional_hours
